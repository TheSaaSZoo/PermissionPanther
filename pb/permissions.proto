syntax = "proto3";
option go_package = "./pb";

message CheckDirectReq {
  string key = 1;

  string entity = 2;
  string permission = 3;
  string object = 4;
}

message CheckDirectRes {
  // Whether the permission is valid
  bool valid = 1;

  // How many recusrsion levels down did we find the object at
  int32 recursion = 2;
}

message ListEntityRelationsReq {
  string key = 1;

  string entity = 2;
  string permission = 3;
}

message ListObjectRelationsReq {
  string key = 1;

  string object = 2;
  string permission = 3;
}

message RelationsResponse {
  repeated Relation relations = 1;
}

message Relation {
  string entity = 1;
  string permission = 2;
  string object = 3;
}
